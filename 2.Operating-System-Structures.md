# Chapter 2: Operating-System Structures

## Operating System Services

An operating system provides an environment for the execution of programs. It provides certain services to programs and to the users of those programs. These services are generally provided through a set of system calls.

Some common services provided by an operating system are:
-   **User Interface:** Almost all operating systems have a user interface (UI). This can be a Command-Line Interface (CLI), a Graphical User Interface (GUI), or a Batch interface.
-   **Program Execution:** The system must be able to load a program into memory and to run that program. The program must be able to end its execution, either normally or abnormally (indicating error).
-   **I/O Operations:** A running program may require I/O, which may involve a file or an I/O device. For efficiency and protection, users cannot control I/O devices directly. The operating system must provide a means to do I/O.
-   **File-System Manipulation:** The file system is of particular interest. Programs need to read and write files and directories. They also need to create and delete them by name, search for a given file, and list file information.
-   **Communications:** Processes may exchange information, on the same computer or between computers over a network. Communications may be implemented via shared memory or through message passing.
-   **Error Detection:** The OS needs to be constantly aware of possible errors. Errors may occur in the CPU and memory hardware, in I/O devices, and in the user program. For each type of error, the OS should take the appropriate action to ensure correct and consistent computing.
-   **Resource Allocation:** When multiple users or multiple jobs are running concurrently, resources must be allocated to each of them. The OS manages many different types of resources, such as CPU cycles, main memory, and file storage.
-   **Accounting:** To keep track of which users use how much and what kinds of computer resources.
-   **Protection and Security:** The owners of information stored in a multiuser or networked computer system may want to control use of that information. Protection involves ensuring that all access to system resources is controlled. Security of the system from outsiders is also important.

## User and Operating-System Interface

Users can interact with the operating system through one of two main interfaces:

-   **Command-Line Interface (CLI):** This interface allows the user to type commands on a keyboard to interact with the operating system. The commands are processed by a command interpreter, also known as a shell.
-   **Graphical User Interface (GUI):** This interface is a user-friendly desktop metaphor where the user interacts with the operating system by manipulating graphical objects such as icons, windows, and menus.

## System Calls

System calls provide an interface to the services made available by an operating system. These calls are generally available as functions written in C and C++, although certain low-level tasks may have to be written using assembly-language instructions.

When a system call is executed, it is typically treated by the hardware as a software interrupt. Control passes through the interrupt vector to a service routine in the OS, and the mode is switched to kernel mode.

## Types of System Calls

System calls can be grouped roughly into six major categories:

1.  **Process Control:** `fork()`, `exec()`, `wait()`, `exit()`
2.  **File Management:** `open()`, `read()`, `write()`, `close()`
3.  **Device Management:** `ioctl()`, `read()`, `write()`
4.  **Information Maintenance:** `getpid()`, `alarm()`, `sleep()`
5.  **Communication:** `pipe()`, `shmget()`, `socket()`
6.  **Protection:** `chmod()`, `umask()`, `chown()`

## System Programs

System programs, also known as system utilities, provide a convenient environment for program development and execution. Some of them are simply user interfaces to system calls; others are considerably more complex.

They can be divided into these categories:
-   File management
-   Status information
-   File modification
-   Programming-language support
-   Program loading and execution
-   Communications
-   Application programs

## Operating System Design and Implementation

The design of a new operating system is a major task. It is important that the goals of the system be well defined before the design begins.

-   **Design Goals:** The requirements of the system can be divided into user goals and system goals. User goals are criteria such as convenience, reliability, and speed. System goals are criteria such as ease of design, implementation, and maintenance.
-   **Mechanisms and Policies:** A key principle of OS design is the separation of policy from mechanism. Mechanisms determine how to do something; policies determine what will be done.

## Operating System Structure

-   **Monolithic Structure:** The entire operating system works in the kernel space. It is a single large process.
-   **Layered Structure:** The OS is broken up into a number of layers. The bottom layer is the hardware; the highest is the user interface.
-   **Microkernel:** This structure removes all nonessential components from the kernel and implements them as system and user-level programs.
-   **Modules:** Most modern operating systems implement kernel modules. It's a piece of code that can be loaded into the kernel on demand.
-   **Hybrid Systems:** Most operating systems today are hybrid systems, combining different structures. For example, both Linux and Windows are monolithic, but also modular, so new functionality can be added dynamically.

## Virtual Machines

A virtual machine takes the layered approach to its logical conclusion. It treats hardware and the operating system kernel as though they were all hardware. A virtual machine provides an interface that is identical to the bare hardware.

## Operating System Generation

Operating systems are designed to run on any of a class of machines; the system must be configured for each specific computer site. The process of tailoring the operating system to the specific hardware on which it will run is called system generation (SYSGEN).

## System Boot

The procedure of starting a computer by loading the kernel is known as booting the system. A small piece of code known as the bootstrap program or boot loader locates the kernel, loads it into main memory, and starts its execution.